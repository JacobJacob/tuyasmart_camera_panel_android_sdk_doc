
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Device Control Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Device.html" />
    
    
    <link rel="prev" href="Activator_ZigbeeSub.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Overview.html">
            
                <a href="Overview.html">
            
                    
                    Function Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Preparation.html">
            
                <a href="Preparation.html">
            
                    
                    Preparation for integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Integrated.html">
            
                <a href="Integrated.html">
            
                    
                    Integrate SDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="User.html">
            
                <a href="User.html">
            
                    
                    User Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="User_Sdk_Update.html">
            
                <a href="User_Sdk_Update.html">
            
                    
                    SDK account upgrade
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="User_mobile.html">
            
                <a href="User_mobile.html">
            
                    
                    Use Mobile Phone
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="User_email.html">
            
                <a href="User_email.html">
            
                    
                    Use Email
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="User_uid.html">
            
                <a href="User_uid.html">
            
                    
                    User uid Login System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="User_Third_Login.html">
            
                <a href="User_Third_Login.html">
            
                    
                    Third Party Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="User_Logout.html">
            
                <a href="User_Logout.html">
            
                    
                    Modify user information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="User_Logout.html">
            
                <a href="User_Logout.html#log-out-of-the-login-interface">
            
                    
                    Sign out
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="User_Logout.html">
            
                <a href="User_Logout.html#disable-account-deregister-user">
            
                    
                    Disable account
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="User_Data_Model.html">
            
                <a href="User_Data_Model.html">
            
                    
                    Data Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="User_Session.html">
            
                <a href="User_Session.html">
            
                    
                    Handling of Expired Session
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="Home_Manager.html">
            
                <a href="Home_Manager.html">
            
                    
                    Home management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="Home_Manager.html">
            
                <a href="Home_Manager.html">
            
                    
                    Home Management Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="Home_Option.html">
            
                <a href="Home_Option.html">
            
                    
                    Operation Class of Home
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="Home_Member.html">
            
                <a href="Home_Member.html">
            
                    
                    Home Member Management Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="Room.html">
            
                <a href="Room.html">
            
                    
                    Room information management
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="Activator.html">
            
                <a href="Activator.html">
            
                    
                    Network Configuration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="Activator_Wifi.html">
            
                <a href="Activator_Wifi.html#ez-mode-configuration">
            
                    
                    EZ Mode Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="Activator_Wifi.html">
            
                <a href="Activator_Wifi.html#ap-mode-configuration">
            
                    
                    AP Mode Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="Activator_Zigbee.html">
            
                <a href="Activator_Zigbee.html">
            
                    
                    ZigBee Gateway Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="Activator_ZigbeeSub.html">
            
                <a href="Activator_ZigbeeSub.html">
            
                    
                    ZigBee Sub-device Configuration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.8" data-path="Device.html">
            
                <a href="Device.html">
            
                    
                    Device Control
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="Device.html">
            
                <a href="Device.html#function-points-of-device">
            
                    
                    Function Points of Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="Device.html">
            
                <a href="Device.html#device-control">
            
                    
                    Device Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="Device.html">
            
                <a href="Device.html#device-renaming">
            
                    
                    Device Renaming
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="Device.html">
            
                <a href="Device.html#remove-device">
            
                    
                    Remove Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="Device.html">
            
                <a href="Device.html#obtain-wifi-signal-strength-of-device">
            
                    
                    Obtain Wifi signal strength of device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="OTA.html">
            
                <a href="OTA.html">
            
                    
                    Firmware upgrade
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.7" data-path="Gateway.html">
            
                <a href="Gateway.html">
            
                    
                    Gateway
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="Shared.html">
            
                <a href="Shared.html">
            
                    
                    Shared devices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="Shared_Device_add.html">
            
                <a href="Shared_Device_add.html">
            
                    
                    Add for Sharing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="Shared_Device_Remove.html">
            
                <a href="Shared_Device_Remove.html">
            
                    
                    Removing Sharing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="Shared_Device_Rename.html">
            
                <a href="Shared_Device_Rename.html">
            
                    
                    Modifying Remark Name
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="Timer.html">
            
                <a href="Timer.html">
            
                    
                    Timer task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="Group.html">
            
                <a href="Group.html">
            
                    
                    Group Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="Group.html">
            
                <a href="Group.html">
            
                    
                    Group Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="Group_wifi.html">
            
                <a href="Group_wifi.html">
            
                    
                    Wifi Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="Group_zigbee.html">
            
                <a href="Group_zigbee.html">
            
                    
                    Zigbee Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="Group_control.html">
            
                <a href="Group_control.html">
            
                    
                    Group Control
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="SmartScene_Manager.html">
            
                <a href="SmartScene_Manager.html">
            
                    
                    Smart scene
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="SmartScene_Manager.html">
            
                <a href="SmartScene_Manager.html#Smart">
            
                    
                    Smart scene
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="SmartScene_Manager.html">
            
                <a href="SmartScene_Manager.html#Scene_operation">
            
                    
                    Scene operation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="Device_Data_Channel.html">
            
                <a href="Device_Data_Channel.html">
            
                    
                    Device data channel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="Message.html">
            
                <a href="Message.html">
            
                    
                    Message Center
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="Message.html">
            
                <a href="Message.html">
            
                    
                    Message list
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="MessagePush.html">
            
                <a href="MessagePush.html">
            
                    
                    Message push switch
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="Feedback.html">
            
                <a href="Feedback.html">
            
                    
                    Feedback
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="BLE.html">
            
                <a href="BLE.html">
            
                    
                    Bluetooth Low Energy
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="BLE_Prepare.html">
            
                <a href="BLE_Prepare.html">
            
                    
                    BLE Prepare
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.2" data-path="BLE_Activator.html">
            
                <a href="BLE_Activator.html">
            
                    
                    BLE Scan And Activator
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.3" data-path="BLE_Operator.html">
            
                <a href="BLE_Operator.html">
            
                    
                    BLE Device Operate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.4" data-path="BLE_OTA.html">
            
                <a href="BLE_OTA.html">
            
                    
                    BLE OTA
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="Push.html">
            
                <a href="Push.html">
            
                    
                    Integrate Push
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="Push_fcm.html">
            
                <a href="Push_fcm.html">
            
                    
                    FCM Push
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="Push_umeng.html">
            
                <a href="Push_umeng.html">
            
                    
                    Umeng
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="CommonInterface.html">
            
                <a href="CommonInterface.html">
            
                    
                    Common Interface
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="Mesh.html">
            
                <a href="Mesh.html">
            
                    
                    Bluetooth Mesh (TUYA)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.20.1" data-path="Mesh_Prepare.html">
            
                <a href="Mesh_Prepare.html">
            
                    
                    Prepare
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.2" data-path="Mesh_IDEA.html">
            
                <a href="Mesh_IDEA.html">
            
                    
                    Basic Notion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.3" data-path="Mesh_Admin.html">
            
                <a href="Mesh_Admin.html">
            
                    
                    Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.4" data-path="Mesh_Config.html">
            
                <a href="Mesh_Config.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.5" data-path="Mesh_Device.html">
            
                <a href="Mesh_Device.html">
            
                    
                    Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.6" data-path="Mesh_Group_Operate.html">
            
                <a href="Mesh_Group_Operate.html">
            
                    
                    Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.7" data-path="Mesh_Device_Operate.html">
            
                <a href="Mesh_Device_Operate.html">
            
                    
                    Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.8" data-path="Mesh_OTA.html">
            
                <a href="Mesh_OTA.html">
            
                    
                    Firmware Upgrade
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="Mesh.html">
            
                <a href="Mesh.html">
            
                    
                    Bluetooth Mesh (SIG)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.21.1" data-path="SigMesh_Prepare.html">
            
                <a href="SigMesh_Prepare.html">
            
                    
                    Prepare
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.2" data-path="SigMesh_IDEA.html">
            
                <a href="SigMesh_IDEA.html">
            
                    
                    Basic Notion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.3" data-path="SigMesh_Admin.html">
            
                <a href="SigMesh_Admin.html">
            
                    
                    Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.4" data-path="SigMesh_Config.html">
            
                <a href="SigMesh_Config.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.5" data-path="SigMesh_Device.html">
            
                <a href="SigMesh_Device.html">
            
                    
                    Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.6" data-path="SigMesh_Group_Operate.html">
            
                <a href="SigMesh_Group_Operate.html">
            
                    
                    Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.7" data-path="SigMesh_Device_Operate.html">
            
                <a href="SigMesh_Device_Operate.html">
            
                    
                    Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.8" data-path="SigMesh_OTA.html">
            
                <a href="SigMesh_OTA.html">
            
                    
                    Firmware Upgrade
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.22" data-path="ErrorCode.html">
            
                <a href="ErrorCode.html">
            
                    
                    Error Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23" data-path="Problems.html">
            
                <a href="Problems.html">
            
                    
                    Frequently Asked Questions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24" data-path="ChangeLog.html">
            
                <a href="ChangeLog.html">
            
                    
                    Change Log
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.24.1" data-path="Update_3_14_0.html">
            
                <a href="Update_3_14_0.html">
            
                    
                    3.13.0 Upgrade 3.14.x Guide
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Device Control</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="acquisition-of-device-information">Acquisition of Device Information</h2>
<p><strong>[Description]</strong></p>
<p>Tuya Smart provides a lot of interfaces for developers to realize the acquisition of device information and management capabilities (removal, and so on). Receivers shall be informed of the device-related return data by means of asynchronous messages.</p>
<p><strong>[Notes]</strong></p>
<ul>
<li>For the device control, the data must be initialized first; namely, TuyaHomeSdk.newHomeInstance(homeId).getHomeDetail(ITuyaHomeResultCallback callback) must be invoked first.</li>
<li>If you need to use latitude and longitude to device control, you need to call TuyaSdk.setLatAndLong before the distribution network, where lon and lat are used to indicate latitude and longitude information.</li>
</ul>
<h2 id="device-operation-control">Device Operation Control</h2>
<p>The ITuyaDevice class provides the device status notification capability. By registering callback functions, developers can easily obtain notifications on device data reception, device removal, online/offline status of device, and mobile network changes. In addition, it also provides an interface for controlling command issuing and device firmware upgrade.</p>
<pre><code class="lang-java"><span class="hljs-comment">// Initialize the device control class based on the device id.</span>
ITuyaDevice mDevice = TuyaHomeSdk.newDeviceInstance(deviceBean.getDevId());
</code></pre>
<h2 id="function-points-of-device">Function Points of Device</h2>
<p>The dps attribute of the DeviceBean class defines the state of the device, and is called the data point (DP) or the function point. Each key in the dps dictionary refers to a dpId of a function point, and the dpValue is the value of the function point. Refer to the functions of product on the <a href="https://iot.tuya.com/index" target="_blank">Tuya developer platform </a>for definition of function points of products. For details of function points, please refer to the <a href="https://docs.tuya.com/zh/iot/configure-in-platform/function-definition/custom-functions#%E5%8A%9F%E8%83%BD%E7%82%B9%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5" target="_blank">Functional Point Related Concepts</a></p>
<p><strong>[Command Format]</strong></p>
<p>The control commands shall be sent in the format given below. {&quot;(dpId)&quot;:&quot;(dpValue)&quot;}</p>
<p><strong>[Example of Function Point]</strong></p>
<p>A product interface on the development platform is as follows:<img src="images/ios_dp_sample.jpeg" alt="&#x529F;&#x80FD;&#x70B9;"> </p>
<p>According to the definition of function points of the product in the back end, the example codes is as follows.</p>
<pre><code class="lang-java"><span class="hljs-comment">// Example for boolean type function point with dpId set to 101. Function: turn on switch. </span>

dps = {<span class="hljs-string">&quot;101&quot;</span>: <span class="hljs-keyword">true</span>};

<span class="hljs-comment">// Example of string type function point with dpId set to 102. Function: set RGB to ff5500.</span>

dps = {<span class="hljs-string">&quot;102&quot;</span>: <span class="hljs-string">&quot;ff5500&quot;</span>};

<span class="hljs-comment">// Example of enumeration type function point with dpId set to 103. Function: set gear to position 2.</span>

dps = {<span class="hljs-string">&quot;103&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>};

<span class="hljs-comment">// Example of value type function point with dpId set to 104. Function: set temperature to 20 centigrade degree.</span>

dps = {<span class="hljs-string">&quot;104&quot;</span>: <span class="hljs-number">20</span>};

<span class="hljs-comment">// Example of transparent (byte array) function point with dpId set to 105. Function: transparently transfer infrared data (i.e., 1122).</span>

dps = {<span class="hljs-string">&quot;105&quot;</span>: <span class="hljs-string">&quot;1122&quot;</span>};

<span class="hljs-comment">// Send multiple dp data in one time.</span>

dps = {<span class="hljs-string">&quot;101&quot;</span>: <span class="hljs-keyword">true</span>, <span class="hljs-string">&quot;102&quot;</span>: <span class="hljs-string">&quot;ff5500&quot;</span>};

mDevice.publishDps(dps, <span class="hljs-keyword">new</span> IControlCallback() {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(String code, String error)</span> </span>{
                        <span class="hljs-comment">//Error code 11001</span>
        <span class="hljs-comment">//In the following cases:</span>
        <span class="hljs-comment">//1. Type error send to, for example, string type format, being        sent to boolean type data</span>
        <span class="hljs-comment">//2. Read-only type DP data can not be sent. Reference to SchemaBean getMode &quot;ro&quot; is read-only type.</span>
        <span class="hljs-comment">//3, raw format send data format is not a hexadecimal string.</span>
        }
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">()</span> </span>{
        }
    });
</code></pre>
<p><strong>[Notes]</strong></p>
<ul>
<li>Special attention shall be paid to the type of data in sending the control commands. 
   For example, the data type of function points shall be value, and {&quot;104&quot;: 25} shall be sent as the control command, instead of {&quot;104&quot;: &quot;25&quot;}.</li>
<li>For the transparent transmission, the byte array shall be the string format, and the string must have even bits. 
   The correct format shall be: {&quot;105&quot;: &quot;0110&quot;}, instead of {&quot;105&quot;: &quot;110&quot;}.</li>
</ul>
<h2 id="device-control">Device control</h2>
<p>Device control supports three kinds of channel control, LAN control, cloud control, and automatic mode (if LAN is online, first go LAN control, LAN is not online, go cloud control)</p>
<h5 id="lan-control">LAN control:</h5>
<pre><code class="lang-java">mDevice.publishDps(commandStr, TYDevicePublishModeEnum.TYDevicePublishModeLocal, callback);
</code></pre>
<h5 id="cloud-control">Cloud control</h5>
<pre><code class="lang-java">mDevice.publishDps(commandStr, TYDevicePublishModeEnum.TYDevicePublishModeInternet, callback);
</code></pre>
<h5 id="auto-mode">Auto mode</h5>
<pre><code class="lang-java">mDevice.publishDps(commandStr, TYDevicePublishModeEnum.TYDevicePublishModeAuto, callback);
</code></pre>
<h3 id="initializing-data-listener">Initializing Data Listener</h3>
<p><strong>[Description]</strong></p>
<p>The TuyaHomeDevice provides listeners for device-related information (dp data, device name, online status of device, and device removal), and the information will be synchronized here in real time.</p>
<p><strong>[Callback]</strong></p>
<pre><code class="lang-java">mDevice.registerDevListener(<span class="hljs-keyword">new</span> IDevListener() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDpUpdate</span><span class="hljs-params">(String devId, String dpStr)</span> </span>{
    <span class="hljs-comment">// dp data update: devId and corresponding dp data.</span>
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onRemoved</span><span class="hljs-params">(String devId)</span> </span>{

    <span class="hljs-comment">// The device is removed.</span>
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onStatusChanged</span><span class="hljs-params">(String devId, <span class="hljs-keyword">boolean</span> online)</span> </span>{
    <span class="hljs-comment">// Status of device: online.</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onNetworkStatusChanged</span><span class="hljs-params">(String devId, <span class="hljs-keyword">boolean</span> status)</span> </span>{
    <span class="hljs-comment">// Network status listener</span>
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDevInfoUpdate</span><span class="hljs-params">(String devId)</span> </span>{
    <span class="hljs-comment">// Device information change (currently, only the device name change requires the interface invocation)</span>
    }

});
</code></pre>
<h2 id="data-issuing">Data Issuing</h2>
<p><strong>[Description]</strong></p>
<p>Send control commands to the device through the LAN or the cloud.</p>
<p><strong>[Method Invocation]</strong></p>
<pre><code class="lang-java"><span class="hljs-comment">// Send control commands to the hardware.</span>

mDevice.send(String command,IControlCallback callback);
</code></pre>
<p><strong>[Example Codes]</strong></p>
<p>Take the light product as an example.</p>
<p>(1) Defining the dp point of light switch</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String STHEME_LAMP_DPID_101 = <span class="hljs-string">&quot;101&quot;</span>; <span class="hljs-comment">//light switch</span>
</code></pre>
<p>(2) Data structure of light switch</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LampBean</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> open;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOpen</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> open;
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setOpen</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> open)</span> </span>{
        <span class="hljs-keyword">this</span>.open = open;
    }
}
</code></pre>
<p>(3) Device initialization</p>
<pre><code class="lang-java"><span class="hljs-comment">/**
* Device object. All dp changes for this device will be returned via callback.
* Before the device initialization, please make sure that the connection server has been initialized; otherwise, the information returned by the server cannnot be obtained.
 */</span>

mDevice = <span class="hljs-keyword">new</span> TuyaHomeSdk.newDeviceInstance(mDevId);

mDevice.registerDevListener(<span class="hljs-keyword">new</span> IDevListener() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDpUpdate</span><span class="hljs-params">(String devId, String dpStr)</span> </span>{
        <span class="hljs-comment">// dp data update: devId and corresponding dp data.</span>
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onRemoved</span><span class="hljs-params">(String devId)</span> </span>{
        <span class="hljs-comment">// The device is removed.</span>
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onStatusChanged</span><span class="hljs-params">(String devId, <span class="hljs-keyword">boolean</span> online)</span> </span>{
        <span class="hljs-comment">// Status of device: online.</span>
        <span class="hljs-comment">// The statusChange refers to whether the communication between the hardware device and the cloud is normal.</span>
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onNetworkStatusChanged</span><span class="hljs-params">(String devId, <span class="hljs-keyword">boolean</span> status)</span> </span>{
        <span class="hljs-comment">// Network status listener</span>
        <span class="hljs-comment">// The onNetworkStatusChanged refers to whether the communication between the mobile phone and the cloud is normal.</span>
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDevInfoUpdate</span><span class="hljs-params">(String devId)</span> </span>{
        <span class="hljs-comment">// Device information change (currently, only the device name change requires the interface invocation)</span>
    }
});
</code></pre>
<p>(4) Code segment for switching on the light</p>
<pre><code class="lang-java"> <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">openLamp</span><span class="hljs-params">()</span> </span>{
    LampBean bean = <span class="hljs-keyword">new</span> LampBean();
    bean.setOpen(<span class="hljs-keyword">true</span>);
    HashMap&lt;String, Object&gt; hashMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();
    hashMap.put(STHEME_LAMP_DPID_101, bean.isOpen());
    mDevice.publishDps(JSONObject.toJSONString(hashMap), <span class="hljs-keyword">new</span> IControlCallback() {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(String code, String error)</span> </span>{
           Toast.makeText(mContext, <span class="hljs-string">&quot;turning on the light failed&quot;</span>, Toast.LENGTH_SHORT).show();
        }
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">()</span> </span>{
            Toast.makeText(mContext, <span class="hljs-string">&quot;turning on the light success&quot;</span>, Toast.LENGTH_SHORT).show();
        }
    });
}
</code></pre>
<p>(5) Cancel device listener event</p>
<pre><code class="lang-java">mDevice.unRegisterDevListener();
</code></pre>
<p>(6) Device resource destruction</p>
<pre><code class="lang-java">mDevice.onDestroy();
</code></pre>
<p><strong>[Notes]</strong></p>
<ul>
<li>The successful issuing of a command does not mean that the device is successfully operated, but only means that the command has been successfully sent. If the operation succeeds, the dp data information will be reported, and returned through the IDevListener onDpUpdate interface.</li>
<li>The command string is converted to JsonString in the format of Map<string dpid,object="" dpvalue="">.</string></li>
<li>The command can send multiple dp data at a time.</li>
</ul>
<h2 id="querying-device-information">Querying Device Information</h2>
<p><strong>[Description]</strong></p>
<p>Query single dp data; query the latest data of the dp from the device; those data will be called back via the IDevicePanelCallback onDpUpdate interface.</p>
<p><strong>[Method Invocation]</strong></p>
<p>mDevice.getDp(String dpId, IResultCallback callback);</p>
<p><strong>[Example Codes]</strong></p>
<pre><code class="lang-java"><span class="hljs-number">1</span>. It is achieved by invoking the mTuyaDevice.getDp method.
<span class="hljs-number">2</span>. The data will be reported via the dp data upgrade listener.

IDevListener.onDpUpdate(String devId,String dpStr)
</code></pre>
<p><strong>[Notes]</strong></p>
<ul>
<li>This interface is mainly for the dp points where the data will not be reported automatically. The dp data values for regular query can be obtained through getDps() in DeviceBean.</li>
</ul>
<h2 id="device-renaming">Device Renaming</h2>
<p><strong>[Description]</strong></p>
<p>Device renaming can be conducted in multiple devices synchronously.</p>
<p><strong>[Method Invocation]</strong></p>
<pre><code class="lang-java"><span class="hljs-comment">// Rename</span>
mDevice.renameDevice(String name,IResultCallback callback);
</code></pre>
<p><strong>[Example Codes]</strong></p>
<pre><code class="lang-java">mDevice.renameDevice(<span class="hljs-string">&quot;device name&quot;</span>, <span class="hljs-keyword">new</span> IResultCallback() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(String code, String error)</span> </span>{
        <span class="hljs-comment">// Renaming failed</span>
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// Renaming succeeded</span>
    }
});
</code></pre>
<p>After renaming succeeded, IDevListener.onDevInfoUpdate() will be notified.</p>
<p>Invoke the following method to get the latest data, and then refresh the device information.</p>
<pre><code class="lang-java">TuyaHomeDataManager.getInstance().getDeviceBean(String devId);
</code></pre>
<h2 id="remove-device">Remove Device</h2>
<p><strong>[Description]</strong></p>
<p>It is used to remove a device from the list of user devices.</p>
<p><strong>[Method Invocation]</strong></p>
<pre><code class="lang-java"><span class="hljs-comment">/**
* Remove device
*
* <span class="hljs-doctag">@param</span> callback
*/</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">removeDevice</span><span class="hljs-params">(IResultCallback callback)</span></span>;
</code></pre>
<p><strong>[Example Codes]</strong></p>
<pre><code class="lang-java">mDevice.removeDevice(<span class="hljs-keyword">new</span> IResultCallback() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(String errorCode, String errorMsg)</span> </span>{
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">()</span> </span>{
    }

});
</code></pre>
<h2 id="obtain-wifi-signal-strength-of-device">Obtain Wifi signal strength of device</h2>
<h5 id="&#x3010;description&#x3011;">&#x3010;Description&#x3011;</h5>
<p>Obtain Wifi signal strength of device</p>
<h5 id="&#x3010;method-invocation&#x3011;">&#x3010;Method Invocation&#x3011;</h5>
<pre><code class="lang-java">
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">requestWifiSignal</span><span class="hljs-params">(WifiSignalListener listener)</span></span>;
</code></pre>
<h5 id="&#x3010;example-codes&#x3011;">&#x3010;Example Codes&#x3011;</h5>
<pre><code class="lang-java">mDevice.requestWifiSignal(<span class="hljs-keyword">new</span> WifiSignalListener() {

     <span class="hljs-meta">@Override</span>
     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSignalValueFind</span><span class="hljs-params">(String signal)</span> </span>{

     }

     <span class="hljs-meta">@Override</span>
     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(String errorCode, String errorMsg)</span> </span>{

     }
 });;
</code></pre>
<h4 id="devicebean">DeviceBean</h4>
<table>
<thead>
<tr>
<th style="text-align:center">Field</th>
<th style="text-align:center">Type</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">iconUrl</td>
<td style="text-align:center">String</td>
<td style="text-align:center">device icon</td>
</tr>
<tr>
<td style="text-align:center">IsOnline</td>
<td style="text-align:center">Boolean</td>
<td style="text-align:center">Whether the device is online (LAN or Cloud Online)</td>
</tr>
<tr>
<td style="text-align:center">name</td>
<td style="text-align:center">String</td>
<td style="text-align:center">device&apos;s name</td>
</tr>
<tr>
<td style="text-align:center">schema</td>
<td style="text-align:center">String</td>
<td style="text-align:center">Device Control Data Point Type Information</td>
</tr>
<tr>
<td style="text-align:center">productId</td>
<td style="text-align:center">String</td>
<td style="text-align:center">Product ID, the same product ID, Schema information consistent</td>
</tr>
<tr>
<td style="text-align:center">supportGroup</td>
<td style="text-align:center">Boolean</td>
<td style="text-align:center">whether the device support groups? If not, you can go to the open platform to turn on this feature</td>
</tr>
<tr>
<td style="text-align:center">Time</td>
<td style="text-align:center">Long</td>
<td style="text-align:center">Device Activation Time</td>
</tr>
<tr>
<td style="text-align:center">pv</td>
<td style="text-align:center">String</td>
<td style="text-align:center">Gateway Protocol Version</td>
</tr>
<tr>
<td style="text-align:center">bv</td>
<td style="text-align:center">String</td>
<td style="text-align:center">Gateway Universal Firmware Version</td>
</tr>
<tr>
<td style="text-align:center">schemaMap</td>
<td style="text-align:center">Map</td>
<td style="text-align:center">Schema Cached Data</td>
</tr>
<tr>
<td style="text-align:center">dps</td>
<td style="text-align:center">Map</td>
<td style="text-align:center">Device Data</td>
</tr>
<tr>
<td style="text-align:center">isShare</td>
<td style="text-align:center">Boolean</td>
<td style="text-align:center">a shared device</td>
</tr>
<tr>
<td style="text-align:center">virtual</td>
<td style="text-align:center">Boolean</td>
<td style="text-align:center">is it a virtual device</td>
</tr>
<tr>
<td style="text-align:center">lon, lat</td>
<td style="text-align:center">String</td>
<td style="text-align:center">Longitude and Latitude Information</td>
</tr>
<tr>
<td style="text-align:center">IsLocalOnline</td>
<td style="text-align:center">Boolean</td>
<td style="text-align:center">Device LAN Online Status</td>
</tr>
<tr>
<td style="text-align:center">nodeId</td>
<td style="text-align:center">String</td>
<td style="text-align:center">Device for gateway and subdevice type, which is an attribute of the subdevice and identifies its short address ID which one gateway have a unique nodeId for each subdevice</td>
</tr>
<tr>
<td style="text-align:center">timezoneId</td>
<td style="text-align:center">String</td>
<td style="text-align:center">Device time zone</td>
</tr>
<tr>
<td style="text-align:center">category</td>
<td style="text-align:center">String</td>
<td style="text-align:center">Device Type</td>
</tr>
<tr>
<td style="text-align:center">MeshId</td>
<td style="text-align:center">String</td>
<td style="text-align:center">Device for gateway and subdevice type, which is an attribute of subdevice and identifies its gateway ID</td>
</tr>
<tr>
<td style="text-align:center">devId</td>
<td style="text-align:center">String</td>
<td style="text-align:center">Device unique identifier id</td>
</tr>
<tr>
<td style="text-align:center">isZigBeeWifi</td>
<td style="text-align:center">boolean</td>
<td style="text-align:center">Is it a ZigBee gateway device?</td>
</tr>
<tr>
<td style="text-align:center">hasZigBee</td>
<td style="text-align:center">boolean</td>
<td style="text-align:center">hasZigBee</td>
</tr>
</tbody>
</table>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Activator_ZigbeeSub.html" class="navigation navigation-prev " aria-label="Previous page: ZigBee Sub-device Configuration">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Device.html#function-points-of-device" class="navigation navigation-next " aria-label="Next page: Function Points of Device">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Device Control","level":"1.8","depth":1,"next":{"title":"Function Points of Device","level":"1.8.1","depth":2,"anchor":"#function-points-of-device","path":"resource/Device.md","ref":"./resource/Device.md#function-points-of-device","articles":[]},"previous":{"title":"ZigBee Sub-device Configuration","level":"1.7.4","depth":2,"path":"resource/Activator_ZigbeeSub.md","ref":"./resource/Activator_ZigbeeSub.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"resource/Device.md","mtime":"2019-12-21T03:09:06.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-03-06T06:20:12.578Z"},"basePath":"..","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

